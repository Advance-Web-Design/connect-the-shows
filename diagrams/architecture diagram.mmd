---
query: assume the site is deployed, and if you can add some component diagram and
  emphasis the data flow as well
references:
  - "File: /architecture diagram.mmd"
generationTime: 2025-06-07T15:26:55.882Z
---
flowchart TB
    %% ========================================
    %% LAYER 1: PRESENTATION LAYER (React Frontend - Vercel Edge)
    %% ========================================
    subgraph PRES["üé® PRESENTATION (React - Vercel Edge)"]
        direction TB
        
        subgraph CORE["üéØ Core"]
            APP["App.jsx<br/>Router"] 
            GC["GameContent.jsx<br/>Shell"]
            SS["StartScreen.jsx<br/>Setup"]
        end
        
        subgraph GAME["üéÆ Game Engine"]
            GA["GameplayArea.jsx<br/>Container"]
            GB["GameBoard.jsx<br/>Main+Zoom"]
            NL["NodeLayer.jsx<br/>Position"]
            DN["DraggableNode.jsx<br/>Cards"]
            CL["ConnectionLines.jsx<br/>Paths"]
        end
        
        subgraph SEARCH["üîç Search"]
            SP["SearchPanel.jsx<br/>Input"]
            SPU["SearchPanelUI.jsx<br/>Results"]
            CP["ConnectionsPanel.jsx<br/>Details"]
            SES["SearchEntitiesSidebar.jsx<br/>Browser"]
        end
        
        subgraph UI["üñºÔ∏è UI Components"]
            BH["BoardHeader.jsx<br/>Title+Menu"]
            AC["ActorCard.jsx<br/>Display"]
            ASI["ActorSearchInterface.jsx<br/>Input"]
            VM["VictoryModal.jsx<br/>Win"]
            MENU["Menu.jsx<br/>Nav"]
            INFO["InfoBar.jsx<br/>Status"]
        end
        
        subgraph AUTH["üîê Auth & Pages"]
            LOGIN["Login.jsx"]
            REG["Register.jsx"]
            PROF["Profile.jsx"]
            HTP["HowToPlay.jsx"]
            ABOUT["About.jsx"]
            LB["Leaderboard.jsx"]
            CM["ChallengeMode.jsx"]
        end
    end
    
    %% ========================================
    %% LAYER 2: SERVERLESS BACKEND (Next.js 15 - Vercel Functions)
    %% ========================================
    subgraph BACKEND["üîß SERVERLESS BACKEND (Next.js 15 - Vercel)"]
        direction TB
        
        subgraph API["üöÄ API Routes"]
            SEARCH_API["api/tmdb/search/*<br/>Multi-Search Proxy"]
            ACTOR_API["api/tmdb/actor/*<br/>Actor+Credits"]
            MOVIE_API["api/tmdb/movie/*<br/>Movie+Cast"]
            TV_API["api/tmdb/tv-show/*<br/>TV+Cast"]
        end
        
        subgraph MW_SEC["üõ°Ô∏è Security"]
            MW["middleware.js<br/>CORS Headers"]
            BEARER["Bearer Token<br/>TMDB Security"]
            CACHE["60s Cache<br/>Performance"]
        end
        
        subgraph FEATURES["‚ö° Features"]
            SCALE["Auto-Scaling<br/>Global CDN"]
            ENV["Env Variables<br/>API Security"]
        end
    end
    
    %% ========================================
    %% LAYER 3: BUSINESS LOGIC LAYER (React State + Client Services)
    %% ========================================
    subgraph BIZ["üß† BUSINESS LOGIC (React State + Client Services)"]
        direction TB
        
        subgraph STATE["üìä State"]
            GP["GameProvider.jsx<br/>Central Context"]
            GCX["gameContext.js<br/>Distribution"]
        end
        
        subgraph HOOKS["üé£ Hooks"]
            UG["useGame.js<br/>Mechanics"]
            UB["useBoard.js<br/>Management"]
            USR["useSearch.js<br/>Logic"]
            UZ["useZoom.js<br/>Viewport"]
        end
        
        subgraph CLIENT_SVCS["üì° CLIENT SERVICES"]
            AS["apiService.js<br/>HTTP Client<br/>Error Handling"]
            TS["tmdbService.js<br/>TMDB Integration<br/>Data Processing"]
            FS["firebaseService.js<br/>Firebase Client<br/>Auth+Firestore"]
        end
        
        subgraph UTILS["üõ†Ô∏è Utils"]
            EU["entityUtils.js<br/>Connections"]
            BU["boardUtils.js<br/>Position+Path"]
            SU["searchUtils.js<br/>Fuzzy Search"]
            AU["apiUtils.js<br/>HTTP Helpers"]
            TU["tmdbUtils.js<br/>Image URLs"]
            STU["stringUtils.js<br/>Text Processing"]
        end
    end
    
    %% ========================================
    %% LAYER 4: CLOUD DATA (External Services)
    %% ========================================
    subgraph CLOUD["‚òÅÔ∏è CLOUD DATA (External Services)"]
        direction TB
        
        subgraph TMDB["üé¨ TMDB"]
            TMDB_API["TMDB API v3<br/>Search/Actor/Movie/TV<br/>Authenticated"]
            TMDB_CDN["TMDB Images CDN<br/>Direct Delivery<br/>Profile/Poster"]
        end
        
        subgraph FIREBASE["üî• Firebase"]
            FB_AUTH["Authentication<br/>Login/Register"]
            FB_STORE["Firestore DB<br/>users|gameStats<br/>leaderboard|challenges"]
            FB_FUNC["Cloud Functions<br/>Stats Processing<br/>Leaderboard Updates"]
            FB_RULES["Security Rules<br/>User Access Control"]
        end
        
        subgraph VERCEL_INFRA["üåê Vercel"]
            EDGE["Edge Network<br/>Global Distribution"]
            DEPLOY["Deployments<br/>Auto-Scaling"]
            ANALYTICS["Analytics<br/>Monitoring"]
        end
    end
    
    %% ========================================
    %% DATA FLOWS - OPTIMIZED ARROWS
    %% ========================================
    
    %% Primary App Flow (Thick Blue)
    APP ==> GC
    GC ==> GA
    GA ==> GB
    
    %% Game Engine Flow (Green)
    GB --> NL
    GB --> CL
    NL --> DN
    
    %% Search Flow (Purple)
    GB --> SP
    SP --> SPU
    SP --> SES
    GB --> CP
    
    %% Presentation to Backend (Direct API calls)
    SP ==> SEARCH_API
    AC ==> ACTOR_API
    PROF ==> MOVIE_API
    LB ==> TV_API
    
    %% State Management (Red - Critical)
    GP ==> GCX
    GP ==> UG
    GP ==> UB
    GP ==> USR
    GP ==> UZ
    
    %% Client Services Integration (Orange - Key Path)
    USR ==> AS
    USR ==> TS
    GP ==> FS
    UG --> EU
    UB --> BU
    USR --> SU
    
    %% Backend to Business Logic (Green - API Flow)
    SEARCH_API ==> AS
    ACTOR_API ==> AS
    MOVIE_API ==> AS
    TV_API ==> AS
    
    %% Backend to TMDB (Thick Green)
    SEARCH_API ==> TMDB_API
    ACTOR_API ==> TMDB_API
    MOVIE_API ==> TMDB_API
    TV_API ==> TMDB_API
    
    %% Direct CDN (Dashed Red - Performance)
    DN -.-> TMDB_CDN
    SPU -.-> TMDB_CDN
    AC -.-> TMDB_CDN
    
    %% Firebase Direct (Dashed Orange)
    FS -.-> FB_AUTH
    FS -.-> FB_STORE
    LOGIN -.-> FB_AUTH
    REG -.-> FB_AUTH
    PROF -.-> FB_STORE
    LB -.-> FB_STORE
    FB_STORE -.-> FB_FUNC
    
    %% Utility Integration (Gray)
    TS --> TU
    AS --> AU
    
    %% Infrastructure (Blue)
    BACKEND --> EDGE
    BACKEND --> DEPLOY
    MW --> BEARER
    MW --> CACHE
    
    %% ========================================
    %% STYLING
    %% ========================================
    
    classDef presentationLayer fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
    classDef backendLayer fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px,color:#000
    classDef businessLayer fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#000
    classDef cloudLayer fill:#fff8e1,stroke:#e65100,stroke-width:2px,color:#000
    classDef coreComponent fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000
    
    class PRES,CORE,GAME,SEARCH,UI,AUTH presentationLayer
    class BACKEND,API,MW_SEC,FEATURES backendLayer
    class BIZ,STATE,HOOKS,CLIENT_SVCS,UTILS,AS,TS,FS businessLayer
    class CLOUD,TMDB,FIREBASE,VERCEL_INFRA cloudLayer
    class APP,GP,GB,TMDB_API,FB_AUTH coreComponent